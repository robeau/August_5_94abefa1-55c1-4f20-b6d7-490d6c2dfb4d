<!DOCTYPE html>
<html>
  <head>
    <title>Your Gmail Stats</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="/javascripts/index.js"></script>

  </head>
  <body>
    <h1>Your Gmail Stats <span style="font-size: .7em">since <%= date %></span></h1>
    <p>You have <%= total %> emails, <%= unread %> unread and <%= read %> read. You have <%= attachments %> emails with attachments (There are <%= numTypes %> different types of attachments.).</p>
    <div class="container">
      <div id="container" style="min-width: 310px; height: auto; margin: 0 auto"></div>
      <div id="container2" style="min-width: 310px; height: auto; margin: 0 auto"></div>
      <div id="container3" style="min-width: 310px; height: auto; margin: 0 auto"></div>
    </div>
    <script>

      $(function () {

        $('#container').highcharts({
          chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
          },
          title: {
            text: 'Unread vs Read'
          },
          tooltip: {
            pointFormat: '{series.name}: <b>{point.y}</b>'
          },
          plotOptions: {
            pie: {
              allowPointSelect: true,
              cursor: 'pointer',
              dataLabels: {
                enabled: false
              },
              showInLegend: true
            }
          },
          series: [{
            name: "Emails",
            colorByPoint: true,
            data: [{
              name: "Unread",
              y: <%= unread %>
            }, {
              name: "Read",
              y: <%= read %>,
              sliced: true,
              selected: true
            }]
          }]
        });
        $('#container2').highcharts({
          chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
          },
          title: {
            text: 'Attachments'
          },
          tooltip: {
            pointFormat: '{series.name}: <b>{point.y}</b>'
          },
          plotOptions: {
            pie: {
              allowPointSelect: true,
              cursor: 'pointer',
              dataLabels: {
                enabled: false
              },
              showInLegend: true
            }
          },
          series: [{
            name: "Emails",
            colorByPoint: true,
            data: [{
              name: "Attachments",
              y: <%= attachments %>
            }, {
              name: "No Attachments",
              y: <%= noatt %>,
              sliced: true,
              selected: true
            }]
          }]
        });
        $('#container3').highcharts({
          chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
          },
          title: {
            text: 'Attachment Types'
          },
          tooltip: {
            pointFormat: '{series.name}: <b>{point.y}</b>'
          },
          plotOptions: {
            pie: {
              allowPointSelect: true,
              cursor: 'pointer',
              dataLabels: {
                enabled: false
              },
              showInLegend: true
            }
          },
          series: [{
            name: "Type",
            colorByPoint: true,
            data: [
              //<% for(var i = 0; i < numTypes; i++){ %>
              {
                name: '<%= mimes_arr[i].mtype %>',
                y: <%= mimes_arr[i].count %>
              },
             // <%}%>
              ]
          }]
        });
      });
    </script>
  </body>
</html>
